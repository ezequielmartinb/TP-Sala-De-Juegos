import{a as M,b as c,c as A,d as j,e as O,g as _,i as P,j as k,k as V,l as q,m as z,n as G,o as D,q as Y}from"./chunk-EC2R4OUN.js";import{l as w,n as F}from"./chunk-3UXFVKZA.js";import{Ca as S,Ha as d,K as h,Oa as s,Qa as r,Ra as n,Sa as u,Ta as I,W as g,Wa as x,X as E,Xa as p,bb as i,db as T,sa as l,wb as N,xa as y}from"./chunk-LTGA3DLZ.js";import"./chunk-LJ5XHLMQ.js";import{h as v}from"./chunk-FK42CRUA.js";var C={production:!0,apiUrl:"https://yhxqhnpjtrpqzzmdnxfh.supabase.co",publicAnonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InloeHFobnBqdHJwcXp6bWRueGZoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDY2NTE2NDUsImV4cCI6MjA2MjIyNzY0NX0.4Wb6R7LxMzORJoyCNrWYl3PlHsZ2VsIuPGR5Gp2K7U8"};var b=class t{supabase=N(C.apiUrl,C.publicAnonKey);insertarEncuesta(o){return v(this,null,function*(){let e=localStorage.getItem("username");if(!e)return console.error("\u274C No se encontr\xF3 username en el local storage."),null;if(yield this.verificarEncuestaPorUsuario(e))return console.error("\u274C Usuario ya registrado, no se puede insertar."),null;o.username=e;let{data:m,error:f}=yield this.supabase.from("encuestas").insert([o]).select();return f?(console.error("\u274C Error en Supabase:",f.message),null):m})}verificarEncuestaPorUsuario(o){return v(this,null,function*(){let{data:e,error:a}=yield this.supabase.from("encuestas").select("username").eq("username",o);return a?(console.error("\u274C Error al consultar Supabase:",a.message),!1):e.length>0})}static \u0275fac=function(e){return new(e||t)};static \u0275prov=h({token:t,factory:t.\u0275fac,providedIn:"root"})};function Z(t,o){t&1&&(r(0,"div",2),i(1,` \u2705 Gracias por completar la encuesta
`),n())}function B(t,o){t&1&&(r(0,"small"),i(1,"\u26A0 Este campo es obligatorio."),n())}function L(t,o){t&1&&(r(0,"small"),i(1,"Solo se permiten letras."),n())}function X(t,o){if(t&1&&(r(0,"div"),d(1,B,2,0,"small",7)(2,L,2,0,"small",7),n()),t&2){let e=p(2);l(),s("ngIf",e.Nombre==null||e.Nombre.errors==null?null:e.Nombre.errors.required),l(),s("ngIf",e.Nombre==null||e.Nombre.errors==null?null:e.Nombre.errors.pattern)}}function H(t,o){t&1&&(r(0,"small"),i(1,"\u26A0 Este campo es obligatorio."),n())}function K(t,o){t&1&&(r(0,"small"),i(1,"Solo se permiten letras."),n())}function W(t,o){if(t&1&&(r(0,"div"),d(1,H,2,0,"small",7)(2,K,2,0,"small",7),n()),t&2){let e=p(2);l(),s("ngIf",e.Apellido==null||e.Apellido.errors==null?null:e.Apellido.errors.required),l(),s("ngIf",e.Apellido==null||e.Apellido.errors==null?null:e.Apellido.errors.pattern)}}function $(t,o){t&1&&(r(0,"small"),i(1,"\u26A0 Este campo es obligatorio."),n())}function Q(t,o){t&1&&(r(0,"small"),i(1,"Debe ser mayor de 18 a\xF1os."),n())}function ee(t,o){t&1&&(r(0,"small"),i(1,"Debe ser menor de 99 a\xF1os."),n())}function te(t,o){if(t&1&&(r(0,"div"),d(1,$,2,0,"small",7)(2,Q,2,0,"small",7)(3,ee,2,0,"small",7),n()),t&2){let e=p(2);l(),s("ngIf",e.Edad==null||e.Edad.errors==null?null:e.Edad.errors.required),l(),s("ngIf",e.Edad==null||e.Edad.errors==null?null:e.Edad.errors.min),l(),s("ngIf",e.Edad==null||e.Edad.errors==null?null:e.Edad.errors.max)}}function ne(t,o){t&1&&(r(0,"small"),i(1,"\u26A0 Este campo es obligatorio."),n())}function re(t,o){t&1&&(r(0,"small"),i(1,"Solo se permiten n\xFAmeros."),n())}function oe(t,o){t&1&&(r(0,"small"),i(1,"M\xE1ximo 10 caracteres."),n())}function ae(t,o){t&1&&(r(0,"small"),i(1,"Minimo 10 caracteres."),n())}function ie(t,o){if(t&1&&(r(0,"div"),d(1,ne,2,0,"small",7)(2,re,2,0,"small",7)(3,oe,2,0,"small",7)(4,ae,2,0,"small",7),n()),t&2){let e=p(2);l(),s("ngIf",e.Telefono==null||e.Telefono.errors==null?null:e.Telefono.errors.required),l(),s("ngIf",e.Telefono==null||e.Telefono.errors==null?null:e.Telefono.errors.pattern),l(),s("ngIf",e.Telefono==null||e.Telefono.errors==null?null:e.Telefono.errors.maxlength),l(),s("ngIf",e.Telefono==null||e.Telefono.errors==null?null:e.Telefono.errors.minlength)}}function le(t,o){t&1&&(r(0,"div")(1,"small"),i(2,"Debes seleccionar una opci\xF3n."),n()())}function se(t,o){t&1&&(r(0,"div")(1,"small"),i(2,"Debes seleccionar al menos una opci\xF3n."),n(),u(3,"br"),n())}function me(t,o){t&1&&(r(0,"small"),i(1,"\u26A0 Este campo es obligatorio."),n())}function ce(t,o){t&1&&(r(0,"small"),i(1,"\u26A0 El comentario no puede superar los 180 caracteres."),n())}function ue(t,o){if(t&1&&(r(0,"div",37),d(1,me,2,0,"small",7)(2,ce,2,0,"small",7),n()),t&2){let e=p(2);l(),s("ngIf",e.Comentario==null||e.Comentario.errors==null?null:e.Comentario.errors.required),l(),s("ngIf",e.Comentario==null||e.Comentario.errors==null?null:e.Comentario.errors.maxlength)}}function de(t,o){t&1&&(r(0,"div",38),i(1," \u26A0\uFE0F Ya has enviado una encuesta anteriormente. "),n())}function pe(t,o){if(t&1){let e=I();r(0,"form",3),x("ngSubmit",function(){g(e);let m=p();return E(m.enviarFormulario())}),r(1,"form",4),x("ngSubmit",function(){g(e);let m=p();return E(m.enviarFormulario())}),r(2,"div")(3,"label",5),i(4,"Nombre:"),n(),u(5,"input",6),d(6,X,3,2,"div",7),n(),r(7,"div")(8,"label",8),i(9,"Apellido:"),n(),u(10,"input",9),d(11,W,3,2,"div",7),n(),r(12,"div")(13,"label",10),i(14,"Edad:"),n(),u(15,"input",11),d(16,te,4,3,"div",7),n(),r(17,"div")(18,"label",12),i(19,"Tel\xE9fono:"),n(),u(20,"input",13),d(21,ie,5,4,"div",7),n(),r(22,"div")(23,"label"),i(24,"1 - \xBFCu\xE1l juego te ha divertido m\xE1s?"),n(),u(25,"br")(26,"br"),r(27,"div",14)(28,"label",15),i(29,"Ahorcado "),u(30,"input",16),n(),r(31,"label",17),i(32,"Mayor-Menor "),u(33,"input",18),n(),r(34,"label",19),i(35,"Preguntados "),u(36,"input",20),n(),r(37,"label",21),i(38,"Blackjack "),u(39,"input",22),n(),u(40,"br"),n(),d(41,le,3,0,"div",7),u(42,"br"),n(),r(43,"div")(44,"label"),i(45,"2 - \xBFQu\xE9 caracter\xEDsticas agregar\xEDas para hacer los juegos m\xE1s entretenidos o desafiantes?"),n(),u(46,"br")(47,"br"),r(48,"div",23)(49,"div",24)(50,"label",25),i(51,"M\xE1s niveles de dificultad "),r(52,"input",26),x("change",function(m){g(e);let f=p();return E(f.agregarOEliminarCaracteristica("M\xE1s niveles de dificultad",m))}),n()()(),r(53,"div",24)(54,"label",27),i(55,"Nuevos modos de juego "),r(56,"input",28),x("change",function(m){g(e);let f=p();return E(f.agregarOEliminarCaracteristica("Nuevos modos de juego",m))}),n()()(),r(57,"div",24)(58,"label",29),i(59,"Integraci\xF3n online con amigos "),r(60,"input",30),x("change",function(m){g(e);let f=p();return E(f.agregarOEliminarCaracteristica("Integraci\xF3n con amigos",m))}),n()(),u(61,"br")(62,"br"),n()(),d(63,se,4,0,"div",7),n(),r(64,"div")(65,"label",31),i(66,"3 - Comparte tu experiencia con la aplicaci\xF3n:"),n(),u(67,"br"),r(68,"textarea",32),x("input",function(){g(e);let m=p();return E(m.actualizarContador())}),n(),r(69,"div",33),i(70),n(),d(71,ue,3,2,"div",34),n(),d(72,de,2,0,"div",35),r(73,"button",36),i(74,"Enviar"),n()()()}if(t&2){let e,a=p();s("formGroup",a.formularioEncuesta),l(),s("formGroup",a.formularioEncuesta),l(5),s("ngIf",a.Nombre==null?null:a.Nombre.invalid),l(5),s("ngIf",a.Apellido==null?null:a.Apellido.invalid),l(5),s("ngIf",a.Edad==null?null:a.Edad.invalid),l(5),s("ngIf",a.Telefono==null?null:a.Telefono.invalid),l(20),s("ngIf",(e=a.formularioEncuesta.get("juegoFavorito"))==null?null:e.invalid),l(22),s("ngIf",a.Caracteristicas==null?null:a.Caracteristicas.invalid),l(7),T(" Caracteres ingresados: ",a.contadorCaracteres,"/180 "),l(),s("ngIf",(a.Comentario==null?null:a.Comentario.invalid)&&(a.Comentario==null?null:a.Comentario.touched)),l(),s("ngIf",a.mostrarError),l(),s("disabled",a.formularioEncuesta.invalid)}}var J=class t{constructor(o){this.encuestaService=o}formularioEncuesta;mensajeGracias=!1;mostrarFormulario=!0;contadorCaracteres=0;mostrarError=!1;ngOnInit(){this.formularioEncuesta=new O({nombre:new _("",[c.required,c.pattern("^[a-zA-Z\xF1\xD1\xE1\xE9\xED\xF3\xFA\xC1\xC9\xCD\xD3\xDA ]+$"),c.required]),apellido:new _("",[c.required,c.pattern("^[a-zA-Z\xF1\xD1\xE1\xE9\xED\xF3\xFA\xC1\xC9\xCD\xD3\xDA ]+$"),c.required]),edad:new _("",[c.required,c.min(18),c.max(99)]),telefono:new _("",[c.required,c.pattern(/^\d+$/),c.maxLength(10),c.minLength(10)]),juegoFavorito:new _("",[c.required]),caracteristicas:new D([],[c.required]),comentario:new _("",[c.required,c.maxLength(180)])})}agregarOEliminarCaracteristica(o,e){if(e.target.checked)this.Caracteristicas.push(new _(o));else{let a=this.Caracteristicas.controls.findIndex(m=>m.value===o);this.Caracteristicas.removeAt(a)}}actualizarContador(){this.contadorCaracteres=this.formularioEncuesta.get("comentario")?.value?.length||0}get Nombre(){return this.formularioEncuesta.get("nombre")}get Apellido(){return this.formularioEncuesta.get("apellido")}get Edad(){return this.formularioEncuesta.get("edad")}get Telefono(){return this.formularioEncuesta.get("telefono")}get JuegoFavorito(){return this.formularioEncuesta.get("juegoFavorito")}get Caracteristicas(){return this.formularioEncuesta.get("caracteristicas")}get Comentario(){return this.formularioEncuesta.get("comentario")}enviarFormulario(){return v(this,null,function*(){let o=localStorage.getItem("username");if(!o){console.error("\u274C No se encontr\xF3 username en el local storage.");return}if(this.formularioEncuesta.invalid){this.formularioEncuesta.markAllAsTouched();return}try{if(yield this.encuestaService.verificarEncuestaPorUsuario(o)){console.error("\u26A0\uFE0F Ya has enviado una encuesta anteriormente."),this.mostrarError=!0;return}let a={nombre:this.formularioEncuesta.value.nombre,apellido:this.formularioEncuesta.value.apellido,edad:this.formularioEncuesta.value.edad,telefono:this.formularioEncuesta.value.telefono,juego_favorito:this.formularioEncuesta.value.juegoFavorito,caracteristicas:this.formularioEncuesta.value.caracteristicas,comentario:this.formularioEncuesta.value.comentario,username:o},m=yield this.encuestaService.insertarEncuesta(a);console.log(m),m?(this.mostrarFormulario=!1,this.mensajeGracias=!0):console.error("\u274C Hubo un problema al enviar la encuesta.")}catch(e){console.error("Error al enviar la encuesta:",e instanceof Error?e.message:e)}})}static \u0275fac=function(e){return new(e||t)(y(b))};static \u0275cmp=S({type:t,selectors:[["app-encuesta"]],decls:4,vars:2,consts:[["class","alert alert-success text-center mt-3",4,"ngIf"],["class","container p-4 shadow-lg rounded bg-light",3,"formGroup","ngSubmit",4,"ngIf"],[1,"alert","alert-success","text-center","mt-3"],[1,"container","p-4","shadow-lg","rounded","bg-light",3,"ngSubmit","formGroup"],[3,"ngSubmit","formGroup"],["for","nombre"],["id","nombre","type","text","formControlName","nombre"],[4,"ngIf"],["for","apellido"],["id","apellido","type","text","formControlName","apellido"],["for","edad"],["id","edad","type","number","formControlName","edad"],["for","telefono"],["id","telefono","type","text","formControlName","telefono","maxlength","10"],[1,"radio-group"],["for","ahorcado"],["type","radio","id","ahorcado","formControlName","juegoFavorito","value","Ahorcado"],["for","mayorMenor"],["type","radio","id","mayorMenor","formControlName","juegoFavorito","value","Mayor-Menor"],["for","preguntados"],["type","radio","id","preguntados","formControlName","juegoFavorito","value","Preguntados"],["for","blackjack"],["type","radio","id","blackjack","formControlName","juegoFavorito","value","Blackjack"],[1,"checkbox-group"],[1,"checkbox-item"],["for","niveles"],["type","checkbox","id","niveles",3,"change"],["for","modos"],["type","checkbox","id","modos",3,"change"],["for","integracion"],["type","checkbox","id","integracion",3,"change"],["for","comentario"],["id","comentario","formControlName","comentario","rows","3",1,"form-control",3,"input"],[1,"text-muted"],["class","text-danger",4,"ngIf"],["class","alert alert-danger text-center",4,"ngIf"],["type","submit",3,"disabled"],[1,"text-danger"],[1,"alert","alert-danger","text-center"]],template:function(e,a){e&1&&(r(0,"h1"),i(1,"Encuesta"),n(),d(2,Z,2,0,"div",0)(3,pe,75,12,"form",1)),e&2&&(l(2),s("ngIf",a.mensajeGracias),l(),s("ngIf",a.mostrarFormulario))},dependencies:[F,w,Y,P,M,k,V,A,j,G,q,z],styles:["body[_ngcontent-%COMP%], label[_ngcontent-%COMP%], input[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{color:#000!important}.encuesta-container[_ngcontent-%COMP%]{max-width:700px;margin:auto;padding:25px;background-color:#f1f1f1;border-radius:12px;box-shadow:0 4px 15px #00000026}h1[_ngcontent-%COMP%]{text-align:center;font-size:26px;font-weight:700}input[type=text][_ngcontent-%COMP%], input[type=number][_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{width:100%;padding:12px;margin-top:8px;border:2px solid #ccc;border-radius:8px;font-size:16px;transition:border-color .3s,background-color .3s}input[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus{border-color:#007bff;background-color:#f9f9f9}.checkbox-group[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:12px}button[_ngcontent-%COMP%]{background:linear-gradient(90deg,#007bff,#004494);color:#fff;padding:12px 18px;font-size:18px;font-weight:700;border:none;border-radius:8px;cursor:pointer;width:100%;transition:background .3s ease-in-out,transform .2s}button[_ngcontent-%COMP%]:hover{background:linear-gradient(90deg,#0056b3,#037);transform:scale(1.02)}.alert-success[_ngcontent-%COMP%]{font-size:20px;font-weight:700;color:#fff;background:#28a745;padding:12px;border-radius:8px;text-align:center;box-shadow:0 4px 10px #ee030333}.small-error[_ngcontent-%COMP%]{color:red;font-size:.85rem}.small-info[_ngcontent-%COMP%]{color:gray;font-size:.85rem}small[_ngcontent-%COMP%]{color:red;font-size:.85rem}"]})};export{J as EncuestaComponent};
